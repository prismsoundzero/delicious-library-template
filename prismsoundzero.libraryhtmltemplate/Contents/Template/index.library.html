<!DOCTYPE html>
<html ng-app="musicApp" >
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="media-per-column" content="1000" />
    <meta name="columns-per-page" content="1" />

    <title ng-bind="title || '$fullName'"></title>

    <link rel="icon" type="image/png" href="favicon.png" />
    <!-- build:css(.) css/vendor.css -->
    <!-- bower:css -->
    <link rel="stylesheet" href="bower_components/angular-hotkeys/build/hotkeys.css" />
    <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.css" />
    <!-- endbower -->
    <!-- endbuild -->
    <!-- build:css(.tmp) css/app.css -->
    <link rel="stylesheet" href="css/bootstrap-custom.css" type="text/css"  />
    <link rel="stylesheet" href="css/style.css" type="text/css"  />
    <!-- endbuild -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400|Oswald:300,400,700" type="text/css" />
</head>
<body ng-controller="MusicListController" class="dark" id="top">

<div class="container-fluid" ng-if="::loaded" ng-cloak>
    <div class="top-navbar navbar navbar-dark bg-inverse">
        <a class="navbar-brand" href="index.html">$fullName</a>
        <ul class="nav navbar-nav">
            <li class="nav-item" ng-class="::{'active': shelf.selected}" ng-repeat="shelf in ::shelves track by shelf.href">
                <a class="nav-link" ng-href="{{::shelf.href}}" ng-bind="::shelf.name"></a>
            </li>
        </ul>
        <form class="form-inline result-wrapper pull-right" ng-submit="search()">
            <input id="search" class="form-control" type="text" placeholder="Search" ng-model="models.query">
            <div class="dropdown-menu" ng-hide="!models.query">
                <div class="artists-wrapper" ng-repeat="artist in artists | filter:models.query | limitTo:5 track by artist">
                    <h6 class="dropdown-header" ng-if="$first">Artists</h6>
                    <div class="dropdown-item-wrapper">
                        <a class="dropdown-item" ng-click="selectArtist(artist)">{{::artist}}</a>
                    </div>
                </div>
                <div class="dropdown-divider"></div>
                <div ng-repeat="item in items | filter:{title: models.query} | limitTo:5 track by item.id">
                    <h6 class="dropdown-header" ng-if="$first">Albums</h6>
                    <div class="dropdown-item-wrapper">
                        <a class="dropdown-item" ng-click="selectItem(item)">{{::item.title}} <span class="artist">{{::item.artist}}</span></a>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div ng-show="!models.selected">
        <div class="selected-artist-header col-xs-12" ng-show="models.selectedArtist || models.q">
            <div class="media" ng-if="models.selectedArtist">
                <div class="media-left" ng-if="models.selectedArtistSpotifyImage">
                    <div class="artist-img-wrapper">
                        <span ng-style="{'background-image': 'url(' + models.selectedArtistSpotifyImage.url + ')'}" class="media-object artist-img"></span>
                    </div>
                </div>
                <div class="media-body">
                    <p>
                        {{models.selectedArtist}}
                        <a ng-if="models.selectedArtistSpotifyInfo" ng-href="{{models.selectedArtistSpotifyInfo.external_urls.spotify}}" target="_blank" class="spotify">
                            <span class="fa fa-lg fa-spotify"></span>
                        </a>
                        <a ng-if="models.selectedArtistLastFmInfo" ng-href="{{::models.selectedArtistLastFmInfo.url}}" target="_blank" class="last-fm">
                            <span class="fa fa-lg fa-lastfm-square"></span>
                        </a>
                    </p>
                    <div ng-if="models.selectedArtistLastFmInfo" >
                        <p class="small artist-bio" ng-bind-html="models.selectedArtistLastFmInfo.bio.summary"></p>
                        <ul class="list-inline tags">
                            <li class="list-inline-item" ng-repeat="tag in models.selectedArtistLastFmInfo.tags.tag"><a ng-href="{{::tag.url}}" target="_blank">#{{::tag.name}}</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="selected-artist-header-footer row">
                <div class="col-xs-12">Albums</div>
            </div>
        </div>
        <div class="cards">
            <div id="{{::item.id}}" class="card-wrapper" ng-repeat="item in items | filter:models.q | filter:{artist: models.selectedArtist}:true | orderBy:'+artist' | limitTo:(models.selectedArtist ? undefined : models.limit):models.limitOffset as filteredItems track by item.id">
                <div class="card">
                    <img class="card-img-top" ng-click="selectItem(item)" ng-src="covers/{{::item.id}}-150.png"/>
                    <div class="card-block">
                        <h4 ng-bind="::item.title" ng-click="selectItem(item)"></h4>
                        <p class="card-text" ng-click="selectArtist(item.artist)" ng-bind="::item.artist"></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="limit-select-wrapper clearfix col-xs-12" ng-if="!models.selectedArtist">
            <span class="btn-group btn-group-sm pull-left" role="group">
                <button type="button" class="btn btn-secondary" ng-repeat="limit in models.limits" ng-class="{'active': models.limit === limit}" ng-click="changeLimit(limit)" ng-bind="limit"></button>
                <button type="button" class="btn btn-secondary" ng-class="{'active': !models.limit}" ng-click="changeLimit()">All</button>
            </span>
            <span ng-show="models.limit" class="btn-group btn-group-sm pull-right" template-url="html/pagination.html" uib-pagination total-items="items.length" ng-model="models.currentPage" items-per-page="models.limit" ng-change="changePage()" role="group"></span>
        </div>
    </div>

    <div ng-show="models.selected" class="selected-wrapper" ng-init="models.selectedAlbumSpotifyPlay = false">
        <p>
            <button class="btn btn-secondary" ng-click="back()">Back</button>
        </p>
        <div class="media">
            <div class="media-left">
                <img class="media-object" ng-src="covers/{{models.selected.id}}-150.png"/>
            </div>
            <div class="media-body">
                <h4 class="media-heading" ng-bind="models.selected.title"></h4>
                <div class="artist" ng-bind="models.selected.artist" ng-click="selectArtist(models.selected.artist, $event)"></div>
                <div class="album-info">
                    <header>
                        <span ng-if="models.selectedAlbumSpotifyInfo">
                            <button class="btn btn-secondary btn-sm" ng-hide="models.selectedAlbumSpotifyPlay" ng-click="models.selectedAlbumSpotifyPlay = true"><span class="fa fa-play spotify-play"></span> Play</button>
                            <button class="btn btn-secondary btn-sm" ng-show="models.selectedAlbumSpotifyPlay" ng-click="models.selectedAlbumSpotifyPlay = false"><span class="fa fa-stop spotify-play"></span> Stop</button>
                            <a ng-href="{{::models.selectedAlbumSpotifyInfo.external_urls.spotify}}" target="_blank" class="spotify">
                                <span class="fa fa-lg fa-spotify"></span>
                            </a>
                        </span>
                        <a ng-if="models.selectedAlbumLastFmInfo" ng-href="{{::models.selectedAlbumLastFmInfo.url}}" target="_blank" class="last-fm">
                            <span class="fa fa-lg fa-lastfm-square"></span>
                        </a>
                    </header>
                    <div class="extended-album-info" ng-show="models.selectedAlbumLastFmInfo">
                        <ul class="list-inline tags">
                            <li class="list-inline-item" ng-repeat="tag in models.selectedAlbumLastFmInfo.tags.tag"><a ng-href="{{::tag.url}}" target="_blank">#{{::tag.name}}</a></li>
                        </ul>
                        <p class="album-wiki" ng-bind-html="models.selectedAlbumLastFmInfo.wiki.summary"></p>
                        <ol class="small">
                            <li ng-repeat="track in models.selectedAlbumLastFmInfo.tracks.track">{{::track.name}}</li>
                        </ol>
                    </div>
                </div>
                <div class="spotify-iframe album-info" ng-if="models.selectedAlbumSpotifyPlay">
                    <iframe ng-src="{{models.selectedAlbumSpotifyUrl}}" width="100%" height="380" frameborder="0" allowtransparency="true"></iframe>
                </div>
            </div>
        </div>
    </div>

    <div class="small main-footer">
        <div class="navbar navbar-light bg-faded">
            <ul class="nav navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="https://github.com/prismsoundzero/delicious-library-template">Prism Sound Zero Template</a>
                </li>
            </ul>
            <ul class="nav navbar-nav pull-right">
                <li class="nav-item">
                    <a class="nav-link" href="http://www.delicious-monster.com" target="_blank">Made with Delicious Library</a>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="ng-hide data">
    <span data-model="models.totalItems" copy-value>$totalItems</span>
    <span data-model="models.publishDate" copy-value>$publishDate</span>
    <nav>$shelfNavigation</nav>
    <table>
        <tr>
            <td>
                <div class="medium"> <!-- div.medium is mandatory, the parser looks for it -->
                    $coverImage150
                    <div class="medium-item" data-uuid="$uuidString" title="$title" data-artist="$creatorsCompositeString" data-description="$primaryDescriptionString" data-asin="$asin" data-rating="$rating"></div>
                </div>
            </td>
        </tr>
    </table>
</div>

<!-- build:remove -->
<script src="sample/sample.js"></script>
<!-- endbuild -->
<!-- build:js(.) js/vendor.js -->
<!-- bower:js -->
<script src="bower_components/jquery/dist/jquery.js"></script>
<script src="bower_components/tether/dist/js/tether.js"></script>
<script src="bower_components/angular/angular.js"></script>
<script src="bower_components/angular-sanitize/angular-sanitize.js"></script>
<script src="bower_components/angular-hotkeys/build/hotkeys.js"></script>
<script src="bower_components/angular-spotify/dist/angular-spotify.min.js"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap.js"></script>
<!-- endbower -->
<!-- endbuild -->
<!-- build:js(prismsoundzero.libraryhtmltemplate/Contents/Template) js/app.js -->
<script src="js/config.js"></script>
<script src="js/app.js"></script>
<script src="js/music-list-ctrl.js"></script>
<script src="js/copy-value.js"></script>
<!-- endbuild -->

</body>
</html>
